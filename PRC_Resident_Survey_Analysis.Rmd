---
title: "PRC Survey Analysis"
author: "Samantha Ryan-Lee"
output: html_notebook
---

######Lansing Resident Recycling Contamination Survey
Open date: 10/19/2020
Close date: 10/29/2020
Number of unique survey respondents: (564)
Number of completed survey responses: (503)
Target population for survey: Lansing City Residents
Mode of circulation of survey: Recycle Coach app, CivicSend (email listserv?), social media (Facebook & Twitter), circulated via Neighborhood Resource Coordinator to Neighborhood Associations


```{r}
library(knitr)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readxl)
library(skimr)
library(moderndive)
```

Import Survey Data
```{r}
prc_survey <- read.csv("F:/UMSI Fall 2020/courses/SI538/project_materials/comprehensive_PRCsurvey_data.csv")
View(prc_survey)
```

Cleaned Data Goal:
1. Filter on completion
2. Rename columns for clarity
3. New Respondent ID column
4. Extract start time and end time from start data and end date
5. Extract multiple responses
6. Count total responses
```{r}
completed_responses <- prc_survey %>% 
  rename("duration_in_seconds" = "Duration..in.seconds.", 
         "current_info_receipt" = "Q1", 
         "how_do_you_want_info" = "Q2", 
         "recyclable_paper_disposal" = "Q3.1_1", 
         "nonrecyclable_paper_disposal" = "Q3.1_2", 
         "cardboard_boxboard_disposal" = "Q3.1_3", 
         "recyclable_glass_disposal" = "Q3.1_4", 
         "specialty_glass_disposal" = "Q3.1_5", 
         "recyclable_plastics_disposal" = "Q3.1_6", 
         "plastic_bag_disposal" = "Q3.1_7", 
         "bulky_plastic_disposal" = "Q3.1_8", 
         "polystyrene_foam_disposal" = "Q3.1_9", 
         "recyclable_metals_disposal" = "Q3.1_10",
         "specialty_metals_disposal" = "Q3.1_11", 
         "e_waste_disposal" = "Q3.1_12", 
         "misc_items_disposal" = "Q3.1_13",
         "accepted_item_in_trash" = "Q4_1", 
         "accepted_item_in_trash" = "Q4_1",
         "accepted_item_in_recycling" = "Q4_2",
         "not_accepted_item_in_trash" = "Q4_3",
         "not_accepted_item_in_recycling" = "Q4_4",
         "unsure_item_in_trash" = "Q4_5",
         "unsure_item_in_recycling" = "Q4_6",
         "specialty_recycle_dropoff" = "Q4_7",
         "what_happens_unwashed" = "Q5",
         "what_happens_bagged" = "Q9",
         "what_happens_unsure" = "Q6",) %>%
  separate(StartDate, c("startdate", "starttime"), " ", convert=TRUE) %>%
  separate(EndDate, c("enddate", "endtime"), " ", convert=TRUE ) %>%
  filter(startdate >= "2020-10-19")
completed_responses
```

export completed_responses
```{r}
write.csv(completed_responses, file="F:/UMSI Fall 2020/courses/SI538/project_materials/posted_responses_PRCsurvey_data.csv")
```

Extracting multiple responses (in Python?)
```{r}
completed_responses2 <- completed_responses %>%
  separate(current_info_receipt, c("current_info_receipt_response1", "current_info_receipt_response2"), ",", convert=TRUE)
```

```{r}
prc_survey_wlist <- read.csv("F:/UMSI Fall 2020/courses/SI538/project_materials/recorded_responses_wlists.csv")
prc_survey_wlist
individ_value <- typeof(prc_survey_wlist$current_info_receipt[5])
individ_value
```

Code for dummy variables
```{r}
recyclable_paper_disposal_dummy_test <- prc_survey_wlist %>% select(responseid, recyclable_paper_disposal) %>%
  mutate(recyclable_paper_disposal = recyclable_paper_disposal, dummy = 1) %>%
  spread(key = recyclable_paper_disposal, value = dummy, fill = 0)
View(recyclable_paper_disposal_dummy_test)
```

Create setup for dummy data frames
```{r}
current_info_receipt_dummy <- prc_survey_wlist %>% select(responseid, current_info_receipt) %>%
  mutate(dummy = 1)
write.csv(current_info_receipt_dummy, file="F:/UMSI Fall 2020/courses/SI506/python_files/current_info_receipt_dummy.csv")
```

dummy data frames
```{r}
current_info <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/current_info_dummy_test.csv")
#View(current_info)
num_org <- current_info %>% filter(org == "True") %>% summarize(count=n())
total_responses <- current_info %>% summarize(count = n())
prop_org <-  num_org / total_responses
prop_org

num_compan <- current_info %>% filter(compan == "True") %>% summarize(count=n())
prop_compan <- num_compan / total_responses
prop_compan

num_paper <- current_info %>% filter(paper == "True") %>% summarize(count=n())
prop_paper <- num_paper / total_responses
prop_paper

num_cart <- current_info %>% filter(cart == "True") %>% summarize(count=n())
prop_cart <- num_cart / total_responses
prop_cart

num_website <- current_info %>% filter(website == "True") %>% summarize(count=n())
prop_website <- num_website / total_responses
prop_website

num_socialmed <- current_info %>% filter(social_med == "True") %>% summarize(count=n())
prop_socialmed <- num_socialmed / total_responses
prop_socialmed

num_apps <- current_info %>% filter(apps == "True") %>% summarize(count=n())
prop_apps <- num_apps / total_responses
prop_apps

num_na <- current_info %>% filter(is.na(current_info_receipt)) %>% summarize(count=n())
prop_na <- num_na / total_responses
prop_na

```
```{r}
want_info <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/want_info_dummy_test.csv")
View(want_info)

num_org2 <- want_info %>% filter(org == "True") %>% summarize(num=n())
prop_org2 <-  num_org2 / total_responses
prop_org2

num_compan2 <- want_info %>% filter(compan == "True") %>% summarize(count=n())
prop_compan2 <- num_compan2 / total_responses
prop_compan2

num_paper2 <- want_info %>% filter(paper == "True") %>% summarize(count=n())
prop_paper2 <- num_paper2 / total_responses
prop_paper2

num_cart2 <- want_info %>% filter(cart == "True") %>% summarize(count=n())
prop_cart2 <- num_cart2 / total_responses
prop_cart2

num_website2 <- want_info %>% filter(website == "True") %>% summarize(count=n())
prop_website2 <- num_website2 / total_responses
prop_website2

num_socialmed2 <- want_info %>% filter(social_med == "True") %>% summarize(count=n())
prop_socialmed2 <- num_socialmed2 / total_responses
prop_socialmed2

num_apps2 <- want_info %>% filter(apps == "True") %>% summarize(count=n())
prop_apps2 <- num_apps2 / total_responses
prop_apps2

num_na2 <- want_info %>% filter(is.na(how_do_you_want_info)) %>% summarize(count=n())
prop_na2 <- num_na2 / total_responses
prop_na2
```

dataframe of proportions of types of info received
"proportion_receipt" = c(prop_org, prop_compan, prop_paper, prop_cart, prop_website, prop_socialmed, prop_apps, prop_na), "proportion_want" = c(prop_org2, prop_compan2, prop_paper2, prop_cart2, prop_website2, prop_socialmed2, prop_apps2, prop_na2),
```{r}
info_receipt_props <- data.frame("type_of_receipt" = c("org", "compan", "paper", "cart", "web", "socialmed", "apps", "na"), "recieves"= 0, "wants" = 0,  stringsAsFactors = TRUE)
info_receipt_props$recieves[1] = .126
info_receipt_props$wants[1] = .022
info_receipt_props$recieves[2] = .213
info_receipt_props$wants[2] = .0426
info_receipt_props$recieves[3] = .713
info_receipt_props$wants[3] = .678
info_receipt_props$recieves[4] = .235
info_receipt_props$wants[4] = .274
info_receipt_props$recieves[5] = .662
info_receipt_props$wants[5] = 0
info_receipt_props$recieves[6] = .109
info_receipt_props$wants[6] = .181
info_receipt_props$recieves[7] = .187
info_receipt_props$wants[7] = .265
info_receipt_props$recieves[8] = .022
info_receipt_props$wants[8] = .031

info_receipt_props

ggplot(info_receipt_props, mapping = aes(x=type_of_receipt, y=recieves)) + geom_col(fill="coral") + labs(x="Method Information is Currently Received", y= "proportion")
ggplot(info_receipt_props, mapping = aes(x=type_of_receipt, y=wants)) + geom_col(fill="steel blue") + labs(x="Method Information Wants to be Received", y= "proportion")
```

```{r}
recyclable_paper <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/recyclable_paper_dummy_test.csv")
View(recyclable_paper)
```


```{r}
num_trash <- recyclable_paper %>% filter(trash == "True") %>% summarize(count=n())
prop_trash <- num_trash / total_responses
prop_trash

num_recycle <- recyclable_paper %>% filter(recycle == "True") %>% summarize(count=n())
prop_recycle <- num_recycle / total_responses
prop_recycle

num_dropoff <- recyclable_paper %>% filter(dropoff == "True") %>% summarize(count=n())
prop_dropoff <- num_dropoff / total_responses
prop_dropoff

num_other <- recyclable_paper %>% filter(other == "True") %>% summarize(count=n())
prop_other <- num_other / total_responses
prop_other

num_na3 <- recyclable_paper %>% filter(is.na(recyclable_paper_disposal)) %>% summarize(count=n())
prop_na3 <- num_na3 / total_responses
prop_na3

```
```{r}
nonrecyclable_paper <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/nonrecyclable_paper_dummy_test.csv")
glimpse(nonrecyclable_paper)
```
```{r}
cardboard_boxboard <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/cardboard_boxboard_dummy_test.csv")
glimpse(cardboard_boxboard)
```
```{r}
recyclable_glass <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/recyclable_glass_dummy_test.csv")
glimpse(recyclable_glass)
```
```{r}
specialty_glass <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/specialty_glass_dummy_test.csv")
glimpse(specialty_glass)
```
```{r}
recyclable_plastic <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/recyclable_plastics_dummy_test.csv")
glimpse(recyclable_plastic)
```
```{r}
plastic_bag <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/plastic_bag_dummy_test.csv")
glimpse(plastic_bag)
```
```{r}
bulky_plastic <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/bulky_plastic_dummy_test.csv")
glimpse(bulky_plastic)
```
```{r}
polystyrene <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/polystyrene_dummy_test.csv")
glimpse(polystyrene)
```
```{r}
recyclable_metals <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/recyclable_metals_dummy_test.csv")
glimpse(recyclable_metals)
```
```{r}
specialty_metals <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/specialty_metals_dummy_test.csv")
glimpse(specialty_metals)
```
```{r}
e_waste <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/e_waste_dummy_test.csv")
glimpse(e_waste)
```
```{r}
misc <- read.csv("F:/UMSI Fall 2020/courses/SI506/python_files/PRC_files/PRC_survey_dummies/misc_items_dummy_test.csv")
glimpse(misc)
```

```{r}
disposal_props <- data.frame("method_disposal" = c("trash", "recycle", "dropoff", "other", "na"), "recyclable_paper" = 0, "" = 0, "" = 0,   "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, "" = 0, stringsAsFactors = TRUE)
disposal_props$recyclable_paper[1] = 0
disposal_props$recyclable_paper[2] = 0
disposal_props$recyclable_paper[3] = 0
disposal_props$recyclable_paper[4] = 0
disposal_props$recyclable_paper[5] = 0

info_receipt_props

ggplot(info_receipt_props, mapping = aes(x=type_of_receipt, y=recieves)) + geom_col(fill="coral")
ggplot(info_receipt_props, mapping = aes(x=type_of_receipt, y=wants)) + geom_col(fill="steel blue")
```


Distribution of length of time it took to complete survey
```{r}
ggplot()
```

